# ================================
# AgenticX GraphRAG æ¼”ç¤ºç³»ç»Ÿé…ç½®æ–‡ä»¶
# åŸºäº AgenticX æ ¸å¿ƒæ¨¡å—çš„å®Œæ•´é…ç½®
# é›†æˆ Knowledgeã€Embeddingsã€Storageã€Retrieval å››å¤§æ ¸å¿ƒæ¨¡å—
# ================================

# ================================
# ç³»ç»ŸåŸºç¡€é…ç½® (System Configuration)
# ================================
system:
  name: "agenticx_graphrag_demo"
  version: "1.0.0"
  description: "åŸºäº AgenticX çš„ GraphRAG æ¼”ç¤ºç³»ç»Ÿ"
  environment: "development"  # development, staging, production
  debug: true
  log_level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  
  # å·¥ä½œç›®å½•é…ç½®
  workspace:
    base_dir: "./workspace"
    data_dir: "./workspace/data"
    documents_dir: "./workspace/documents"
    output_dir: "./workspace/output"
    cache_dir: "./workspace/cache"
    logs_dir: "./workspace/logs"
    temp_dir: "./workspace/temp"
  
# ========================================
# LLM é…ç½® (åˆ†å±‚æ¨¡å‹é…ç½®)
# ========================================
llm:
  # é»˜è®¤LLMé…ç½®ï¼ˆç”¨äºSPOæŠ½å–ç­‰è½»é‡ä»»åŠ¡ï¼‰
  provider: "bailian"  # openai, anthropic, litellm, bailian
  model: "qwen3-235b-a22b"  # åŸå§‹ï¼šqwen3-next-80b-a3b-instruct
  api_key: "${BAILIAN_API_KEY}"
  base_url: "${BAILIAN_BASE_URL}"
  temperature: 0.1
  max_tokens: 2048
  timeout: 360
  retry_attempts: 5
  
  # å¼ºæ¨¡å‹é…ç½®ï¼ˆç”¨äºæ–‡æ¡£åˆ†æå’ŒSchemaç”Ÿæˆï¼‰
  strong_model:
    provider: "bailian"
    model: "qwen3-max"  # å¼ºæ¨ç†èƒ½åŠ›æ¨¡å‹ï¼Œ128kä¸Šä¸‹æ–‡
    api_key: "${BAILIAN_API_KEY}"
    base_url: "${BAILIAN_BASE_URL}"
    temperature: 0.1    # ä½æ¸©åº¦ç¡®ä¿ç¨³å®šè¾“å‡º
    max_tokens: 128000  # æœ€å¤§ä¸Šä¸‹æ–‡é•¿åº¦ï¼Œå……åˆ†åˆ©ç”¨
    timeout: 600        # å¢åŠ è¶…æ—¶æ—¶é—´ï¼Œå¤„ç†å¤§æ–‡æ¡£
    retry_attempts: 3
    # é’ˆå¯¹Schemaç”Ÿæˆä¼˜åŒ–çš„å‚æ•°
    top_p: 0.8          # é€‚åº¦çš„å¤šæ ·æ€§
    frequency_penalty: 0.1  # å‡å°‘é‡å¤
    
  # è½»é‡æ¨¡å‹é…ç½®ï¼ˆç”¨äºSPOæŠ½å–ï¼‰
  light_model:
    provider: "bailian"
    model: "qwen3-235b-a22b"  # å¿«é€Ÿæ¨¡å‹
    api_key: "${BAILIAN_API_KEY}"
    base_url: "${BAILIAN_BASE_URL}"
    temperature: 0.1
    max_tokens: 4096
    timeout: 120
    retry_attempts: 5
  
# ========================================
# Knowledge æ¨¡å—é…ç½®
# ========================================
knowledge:
  # æ–‡æ¡£å¤„ç†é…ç½®
  document_processor:
    backend: "structured"  # simple_text, structured, vlm_layout
    complexity_level: "medium"  # low, medium, high
    enable_ocr: false
    enable_table_extraction: true
    enable_image_analysis: false
    
  # æ–‡æ¡£è¯»å–å™¨é…ç½®
  readers:
    pdf:
      enabled: true
      extract_images: false
      extract_tables: true
      page_range: null  # [1, 10] æˆ– null è¡¨ç¤ºå…¨éƒ¨é¡µé¢
    text:
      enabled: true
      encoding: "utf-8"
    json:
      enabled: true
      flatten_nested: true
    csv:
      enabled: true
      delimiter: ","
      header_row: true
    word:
      enabled: true
      extract_images: false
      extract_tables: true
    powerpoint:
      enabled: true
      extract_images: false
      extract_notes: true
      include_slide_numbers: true
      
  # åˆ†å—é…ç½® - æŒ‰ç”¨é€”åˆ†ç¦»
  chunking:
    # çŸ¥è¯†å›¾è°±ä¸“ç”¨åˆ†å—é…ç½® - ç”¨äºçŸ¥è¯†å›¾è°±æ„å»º
    graph_knowledge:
      strategy: "fixed_size"  # å›ºå®šå¤§å°åˆ†å—ï¼Œç¨³å®šå¯é 
      chunk_size: 3000       # é€‚ä¸­å¤§å°ï¼Œå¹³è¡¡ä¸Šä¸‹æ–‡å’Œå¤„ç†æ•ˆç‡
      chunk_overlap: 300     # 10%é‡å ï¼Œä¿æŒè¿ç»­æ€§
      min_chunk_size: 1500   # ç¡®ä¿è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡
      max_chunk_size: 5000   # é¿å…è¿‡é•¿å½±å“æŠ½å–è´¨é‡
    
    # å‘é‡æ£€ç´¢ä¸“ç”¨åˆ†å—é…ç½® - ç”¨äºè¯­ä¹‰æ£€ç´¢
    vector:
      strategy: "fixed_size"  # å›ºå®šå¤§å°ï¼Œå¹³è¡¡æ£€ç´¢ç²¾åº¦
      chunk_size: 1500       # ä¼˜åŒ–ï¼šå……åˆ†åˆ©ç”¨æ¨¡å‹èƒ½åŠ›(~1000 tokens)
      chunk_overlap: 250     # é€‚åº¦é‡å 
      min_chunk_size: 1000   # ä¿è¯æœ€å°è¯­ä¹‰å•å…ƒ
      max_chunk_size: 2200   # ä¸Šé™çº¦1500 tokensï¼Œå®‰å…¨èŒƒå›´å†…
      
    # BM25æ£€ç´¢ä¸“ç”¨åˆ†å—é…ç½® - ç”¨äºå…³é”®è¯æ£€ç´¢  
    bm25:
      strategy: "fixed_size"  # å›ºå®šå¤§å°ï¼Œä¸å‘é‡æ£€ç´¢ä¿æŒä¸€è‡´
      chunk_size: 1500       # ğŸ”§ ä¿®å¤ï¼šä¸å‘é‡æ£€ç´¢ä¿æŒä¸€è‡´ï¼Œä¾¿äºæ··åˆè¯„åˆ†
      chunk_overlap: 250     # ä¸å‘é‡æ£€ç´¢ä¿æŒä¸€è‡´
      min_chunk_size: 1000   # ä¸å‘é‡æ£€ç´¢ä¿æŒä¸€è‡´
      max_chunk_size: 2200   # ä¸å‘é‡æ£€ç´¢ä¿æŒä¸€è‡´
      
  # çŸ¥è¯†å›¾è°±æ„å»ºé…ç½®
  graph_knowledge:
    # æŠ½å–æ–¹æ³•é…ç½®
    extraction_method: "spo"  # "spo" (ä¸¤é˜¶æ®µæŠ½å–) æˆ– "separate" (åˆ†ç¦»æŠ½å–)
    schema_path: "schema.json"  # åŸºç¡€Schemaæ–‡ä»¶è·¯å¾„
    enable_custom_schema: true  # å¯ç”¨å®šåˆ¶Schemaç”Ÿæˆ
    prompts_dir: "prompts"  # æç¤ºè¯æ–‡ä»¶å¤¹è·¯å¾„
    spo_batch_size: 40  # ä½¿ç”¨å•ä¸ªå¤„ç†é¿å…ç½‘ç»œè¿æ¥é—®é¢˜
    
    # å®ä½“æå–é…ç½®
    entity_extraction:
      max_entities_per_chunk: 40  # å¢åŠ æ¯å—æœ€å¤§å®ä½“æ•°
      entity_types:
        - "PERSON"
        - "ORGANIZATION"
        - "LOCATION"
        - "CONCEPT"
        - "EVENT"
        - "TECHNOLOGY"
        - "PRODUCT"
        - "METHOD"      # æ–°å¢ï¼šæ–¹æ³•/ç®—æ³•
        - "FRAMEWORK"   # æ–°å¢ï¼šæ¡†æ¶
        - "COMPONENT"   # æ–°å¢ï¼šç»„ä»¶
      confidence_threshold: 0.6  # é™ä½é˜ˆå€¼ï¼Œæå–æ›´å¤šå®ä½“
      enable_coreference_resolution: true
      
    # å…³ç³»æå–é…ç½®
    relationship_extraction:
      max_relationships_per_chunk: 60  # å¢åŠ æ¯å—æœ€å¤§å…³ç³»æ•°
      relationship_types:
        - "RELATED_TO"
        - "PART_OF"
        - "LOCATED_IN"
        - "WORKS_FOR"
        - "CREATED_BY"
        - "INFLUENCES"
        - "DEPENDS_ON"
        - "IMPLEMENTS"  # æ–°å¢ï¼šå®ç°å…³ç³»
        - "USES"        # æ–°å¢ï¼šä½¿ç”¨å…³ç³»
        - "CONTAINS"    # æ–°å¢ï¼šåŒ…å«å…³ç³»
      confidence_threshold: 0.5  # é™ä½é˜ˆå€¼ï¼Œæå–æ›´å¤šå…³ç³»
      enable_bidirectional: true
      
    # ç¤¾åŒºæ£€æµ‹é…ç½®
    community_detection:
      algorithm: "leiden"  # leiden, louvain, label_propagation
      resolution: 1.0
      max_communities: 100
      min_community_size: 3
      enable_hierarchical: true
      
    # å›¾ä¼˜åŒ–é…ç½®
    graph_optimization:
      enable_entity_merging: true
      entity_similarity_threshold: 0.9
      enable_relationship_pruning: true
      relationship_weight_threshold: 0.3
      enable_noise_reduction: true
      
    # è´¨é‡éªŒè¯é…ç½®
    quality_validation:
      min_entity_confidence: 0.5
      min_relationship_confidence: 0.4
      max_orphaned_entities_ratio: 0.1
      enable_consistency_check: true
      
# ========================================
# Embeddings æ¨¡å—é…ç½®
# ========================================
embeddings:
  # åµŒå…¥è·¯ç”±å™¨é…ç½®
  router:
    primary_provider: "bailian"
    fallback_providers: ["bailian"]
    load_balancing: false
    health_check_interval: 300  # ç§’
    
  # OpenAI åµŒå…¥é…ç½®
  openai:
    model: "text-embedding-3-small"
    api_key: "${OPENAI_API_KEY}"
    # base_url: ""  # ä½¿ç”¨é»˜è®¤URLï¼Œæ³¨é‡Šæ‰nullå€¼
    dimensions: 1024  # ç»Ÿä¸€ä¸º1024ç»´åº¦
    batch_size: 100
    timeout: 30
    
  # SiliconFlow åµŒå…¥é…ç½®
  siliconflow:
    model: "BAAI/bge-m3"
    api_key: "${SILICONFLOW_API_KEY}"
    base_url: "https://api.siliconflow.cn/v1"
    dimensions: 1024  # ä¿æŒ1024ç»´åº¦
    batch_size: 10  # ä¿®å¤ï¼šé™ä½æ‰¹å¤„ç†å¤§å°ä»¥é¿å…APIé™åˆ¶
    
  # ç™¾ç‚¼åµŒå…¥é…ç½®
  # text-embedding-v4ï¼šé€šç”¨å‘é‡ï¼Œæ˜¯é€šä¹‰å®éªŒå®¤åŸºäºQwenç³»åˆ—åŸºåº§çš„å¤šè¯­è¨€æ–‡æœ¬/å¤šæ¨¡æ€ç»Ÿä¸€å‘é‡æ¨¡å‹ï¼Œé¢å‘å…¨çƒå¤šä¸ªä¸»æµè¯­ç§ï¼Œæä¾›é«˜æ°´å‡†çš„å‘é‡æœåŠ¡ï¼Œå¸®åŠ©å¼€å‘è€…å°†æ–‡æœ¬/å›¾ç‰‡/è§†é¢‘æ•°æ®å¿«é€Ÿè½¬æ¢ä¸ºé«˜è´¨é‡çš„å‘é‡æ•°æ®ï¼Œåœ¨æ–‡æœ¬ã€å›¾ç‰‡æ£€ç´¢ã€èšç±»ã€åˆ†ç±»æ€§èƒ½å¤§å¹…æå‡ï¼Œæ”¯æŒ64~2048ç»´ç”¨æˆ·è‡ªå®šä¹‰å‘é‡ç»´åº¦ã€‚
  bailian:
    model: "text-embedding-v4"
    api_key: "${BAILIAN_API_KEY}"
    base_url: "${BAILIAN_BASE_URL}"
    dimensions: 1024  # ç™¾ç‚¼æ”¯æŒ1024ç»´åº¦ï¼Œç»Ÿä¸€è®¾ç½®
    batch_size: 10    # ä¿®å¤ï¼šç™¾ç‚¼APIæ‰¹å¤„ç†å¤§å°é™åˆ¶ä¸º10
    
# ========================================
# Storage æ¨¡å—é…ç½®
# ========================================
storage:
  # å‘é‡å­˜å‚¨é…ç½®
  vector:
    provider: "milvus"  # chroma, milvus, qdrant, faiss, pgvector, weaviate, pinecone
    
    # Chroma é…ç½® (æœ¬åœ°å¼€å‘æ¨è)
    chroma:
      host: "localhost"
      port: 8000
      collection_name: "agenticx_graphrag"
      persist_directory: "./storage/chroma"
      distance_metric: "cosine"  # cosine, l2, ip
      
    # Milvus é…ç½® (ç”Ÿäº§ç¯å¢ƒæ¨è)
    milvus:
      host: "localhost"
      port: 19530
      collection_name: "agenticx_documents"  # ğŸ”§ æ–‡æ¡£å‘é‡ä¸“ç”¨é›†åˆ
      graph_collection_name: "agenticx_graph"  # ğŸ”§ å›¾å‘é‡ä¸“ç”¨é›†åˆ
      database: "default"
      # username: ""  # æ³¨é‡Šæ‰nullå€¼
      # password: ""  # æ³¨é‡Šæ‰nullå€¼
      secure: false
      
    # Qdrant é…ç½®
    qdrant:
      host: "localhost"
      port: 6333
      collection_name: "agenticx_graphrag"
      # api_key: ""  # æœ¬åœ°éƒ¨ç½²ä¸éœ€è¦API key
      prefer_grpc: false
      
  # å›¾å­˜å‚¨é…ç½®
  graph:
    provider: "neo4j"  # neo4j, nebula, arangodb
    
    # Neo4j é…ç½®
    neo4j:
      uri: "${NEO4J_URI}"
      username: "${NEO4J_USERNAME}"
      password: "${NEO4J_PASSWORD}"
      database: "neo4j"
      max_connection_lifetime: 3600
      max_connection_pool_size: 50
      connection_acquisition_timeout: 60
      
    # Nebula Graph é…ç½®
    nebula:
      hosts: ["127.0.0.1:9669"]
      username: "root"
      password: "nebula"
      space_name: "agenticx_graphrag"
      
  # é”®å€¼å­˜å‚¨é…ç½®
  key_value:
    provider: "redis"  # redis, sqlite, memory
    
    # Redis é…ç½®
    redis:
      host: "${REDIS_HOST}"
      port: "${REDIS_PORT}"
      password: "${REDIS_PASSWORD}"
      db: 0
      max_connections: 20
      
    # SQLite é…ç½®
    sqlite:
      database_path: "./storage/cache.db"
      
# ========================================
# Retrieval æ¨¡å—é…ç½®
# ========================================
retrieval:
  # æ··åˆæ£€ç´¢é…ç½®
  hybrid:
    graph_weight: 0.3      # å›¾æ£€ç´¢æƒé‡
    vector_weight: 0.4     # å‘é‡æ£€ç´¢æƒé‡  
    bm25_weight: 0.3       # BM25æ£€ç´¢æƒé‡
    deduplication_threshold: 0.7  # é™ä½å»é‡é˜ˆå€¼ï¼Œä¿ç•™æ›´å¤šç›¸ä¼¼å†…å®¹
    min_combined_score: 0.05      # é™ä½æœ€å°åˆ†æ•°é˜ˆå€¼ï¼Œå¢åŠ å¬å›
    
  # å‘é‡æ£€ç´¢é…ç½®
  vector:
    similarity_metric: "cosine"  # cosine, euclidean, dot_product
    top_k: 50               # ğŸ”§ ä¿®å¤ï¼šé€‚ä¸­çš„å‘é‡æ£€ç´¢æ•°é‡ï¼Œé…åˆé˜ˆå€¼è¿‡æ»¤
    similarity_threshold: 0.5  # ğŸ”§ ä¿®å¤ï¼šä½¿ç”¨åˆç†çš„ç›¸ä¼¼åº¦é˜ˆå€¼ï¼Œæœ‰æ•ˆè¿‡æ»¤ä½è´¨é‡ç»“æœ
    enable_mmr: true  # Maximum Marginal Relevance
    mmr_diversity_bias: 0.3
    
  # å›¾æ£€ç´¢é…ç½®
  graph:
    max_depth: 3
    max_nodes: 30           # ğŸ”§ ä¿®å¤ï¼šé€‚ä¸­çš„å›¾æ£€ç´¢èŠ‚ç‚¹æ•°é‡
    similarity_threshold: 0.3  # ğŸ”§ ä¿®å¤ï¼šåˆç†çš„å›¾æ£€ç´¢ç›¸ä¼¼åº¦é˜ˆå€¼
    relationship_weights: true
    enable_path_ranking: true
    community_aware: true
    
  # BM25 æ£€ç´¢é…ç½®
  bm25:
    k1: 1.2
    b: 0.75
    top_k: 50              # ğŸ”§ ä¿®å¤ï¼šé€‚ä¸­çš„BM25æ£€ç´¢æ•°é‡
    
  # è‡ªåŠ¨æ£€ç´¢é…ç½®
  auto:
    query_analysis_enabled: true
    strategy_selection_model: "gpt-4o-mini"
    confidence_threshold: 0.8
    fallback_strategy: "hybrid"
    
  # é‡æ’åºé…ç½®
  reranker:
    provider: "cross_encoder"  # cross_encoder, llm_reranker, cohere
    model: "cross-encoder/ms-marco-MiniLM-L-6-v2"
    top_k: 50              # å¤§å¹…å¢åŠ é‡æ’åºåçš„ä¿ç•™æ•°é‡
    batch_size: 32
    
  # æŸ¥è¯¢åˆ†æé…ç½®
  query_analysis:
    enable_intent_detection: true
    enable_entity_extraction: true
    enable_query_expansion: true
    expansion_terms: 3
    
# ========================================
# RAG å·¥ä½œæµé…ç½®
# ========================================
rag:
  # æ–‡æ¡£ç´¢å¼•é…ç½®
  indexing:
    batch_size: 100
    enable_incremental: true
    duplicate_detection: true
    quality_filtering: true
    
  # æ£€ç´¢é…ç½®
  retrieval:
    default_top_k: 100         # ğŸ”§ ä¿®å¤ï¼šå¤§å¹…é™ä½é»˜è®¤æ£€ç´¢æ•°é‡ï¼Œæ§åˆ¶ä¸Šä¸‹æ–‡é•¿åº¦
    max_context_length: 32000  # ğŸ”§ ä¿®å¤ï¼šé™ä½æœ€å¤§ä¸Šä¸‹æ–‡é•¿åº¦ï¼Œé¿å…tokenè¶…é™
    enable_context_compression: true
    compression_ratio: 0.8    # ğŸ”§ ä¿®å¤ï¼šæé«˜å‹ç¼©æ¯”ä¾‹ï¼Œå‡å°‘å†—ä½™å†…å®¹
    
  # ç”Ÿæˆé…ç½®
  generation:
    model: "gpt-4o-mini"
    max_tokens: 2048
    temperature: 0.1
    enable_citation: true
    citation_format: "numbered"  # numbered, inline, footnote
    
# ========================================
# æ€§èƒ½ä¼˜åŒ–é…ç½®
# ========================================
performance:
  # ç¼“å­˜é…ç½®
  caching:
    enable_query_cache: true
    enable_embedding_cache: true
    enable_result_cache: true
    cache_ttl: 3600  # ç§’
    max_cache_size: 1000
    
  # å¹¶å‘é…ç½®
  concurrency:
    max_workers: 8        # å¢åŠ å¹¶å‘å·¥ä½œçº¿ç¨‹
    batch_processing: true
    async_operations: true
    spo_batch_size: 1    # SPOæŠ½å–æ‰¹å¤„ç†å¤§å°ï¼Œä½¿ç”¨å•ä¸ªå¤„ç†é¿å…ç½‘ç»œé—®é¢˜
    embedding_batch_size: 40  # åµŒå…¥æ‰¹å¤„ç†å¤§å°
    
  # å†…å­˜ç®¡ç†
  memory:
    max_memory_usage: "2GB"
    enable_memory_monitoring: true
    garbage_collection_interval: 300
    
# ========================================
# ç›‘æ§å’Œæ—¥å¿—é…ç½®
# ========================================
monitoring:
  # æ—¥å¿—é…ç½®
  logging:
    level: "INFO"
    format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
    file_path: "./workspace/logs/agenticx_graphrag.log"
    max_file_size: "10MB"
    backup_count: 5
    
  # æŒ‡æ ‡æ”¶é›†
  metrics:
    enable_performance_metrics: true
    enable_quality_metrics: true
    metrics_export_interval: 60
    
  # å¥åº·æ£€æŸ¥
  health_check:
    enable_service_health_check: true
    check_interval: 30
    timeout: 10
    
# ========================================
# å¼€å‘å’Œè°ƒè¯•é…ç½®
# ========================================
development:
  # è°ƒè¯•é…ç½®
  debug:
    enable_verbose_logging: true
    enable_query_tracing: true
    enable_performance_profiling: false
    
  # æµ‹è¯•é…ç½®
  testing:
    enable_test_mode: false
    mock_external_services: false
    test_data_path: "./test_data"
    
  # å®éªŒæ€§åŠŸèƒ½
  experimental:
    enable_advanced_chunking: false
    enable_multimodal_processing: false
    enable_real_time_updates: false